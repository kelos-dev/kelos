apiVersion: kelos.dev/v1alpha1
kind: TaskSpawner
metadata:
  name: kelos-fake-user
spec:
  when:
    cron:
      schedule: "0 9 * * *"
  maxConcurrency: 1
  taskTemplate:
    workspaceRef:
      name: kelos-agent
    model: sonnet
    type: claude-code
    ttlSecondsAfterFinished: 864000
    credentials:
      type: oauth
      secretRef:
        name: kelos-credentials
    podOverrides:
      resources:
        requests:
          cpu: "250m"
          memory: "512Mi"
          ephemeral-storage: "2Gi"
        limits:
          cpu: "1"
          memory: "2Gi"
          ephemeral-storage: "2Gi"
    agentConfigRef:
      name: kelos-dev-agent
    promptTemplate: |
      You are a developer experience tester for the Kelos framework — a Kubernetes-native controller that runs autonomous AI coding agents.
      Your goal is to improve Kelos so that more developers adopt it. Act as a new user trying out the project for the first time.

      Task:
      Pick ONE of the following areas to focus on (choose the one most likely to have actionable improvements):

      1. **Documentation & Onboarding**
         - Read the README and try to follow the getting-started instructions
         - Check if CLI help text (`kelos --help`, `kelos run --help`, etc.) is clear
         - Look for missing or outdated documentation

      2. **Developer Experience**
         - Review error messages — are they actionable and helpful?
         - Check if common workflows are easy to accomplish
         - Look for rough edges in the CLI or API

      3. **Examples & Use Cases**
         - Review existing examples in `examples/` and `self-development/`
         - Check if example manifests are correct and well-documented
         - Identify missing examples that would help new users

      Actions:
      - If you find an issue, create a GitHub issue:
        ```
        gh issue create --title "<title>" --body "<description>" --label generated-by-kelos --label kelos/needs-input
        ```
      - Do NOT create PRs. Only create issues

      Constraints:
      - Focus on ONE area per run, do it thoroughly
      - Do not create duplicate issues — check existing issues first with `gh issue list`
      - Keep changes minimal and focused
      - Before creating output, review recent issues labeled "generated-by-kelos" (`gh issue list --label generated-by-kelos --limit 10`) to avoid overlap with other agents and to learn what has been well-received vs dismissed
      - If after reviewing existing issues you cannot identify something genuinely new and actionable, exit without creating an issue or PR. Not every run needs to produce output
  pollInterval: 1m
